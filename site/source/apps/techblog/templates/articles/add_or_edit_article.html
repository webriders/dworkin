{% extends 'abstract/base.html' %}

{% block css %}
    <link rel="stylesheet" href="/static/techblog/css/big_forms.css" />
    <link rel="stylesheet" href="/static/techblog/css/pages/add_or_edit_article.css" />
    <link rel="stylesheet" href="/static/pygments/css/highlight_native.css" />
{% endblock css %}

{% block media %}
    {{ form.media }}
{% endblock media %}

{% block content %}
    {% if user.is_authenticated %}
        {% if edit_allowed %}
            <h1 class="big-form-title">Статья</h1>

            <form method="post" class="large-form">
                {% csrf_token %}
                <dl>
                    {% for field in form %}
                        <dt>{{ field.label_tag }}</dt>
                        <dd>
                            {{ field }}
                            {% if field.help_text %}
                                <div class="hint">{{ field.help_text }}</div>
                            {% endif %}
                            {% if field.errors %}
                                <div class="myerrors">{{ field.errors }}</div>
                            {% endif %}
                        </dd>
                    {% endfor %}
                </dl>
                <div class="form-actions">
                    <input type="submit" class="submit-form" name="is_public" value="Опубликовать" />
                    <input type="submit" class="submit-form" name="is_draft" value="В черновики" />
                </div>
            </form>

            <script type="text/javascript">
                // < ![CDATA[
                (function(){ var u = document.getElementById('id_title'); if (u) u.focus(); })();
                // ]]>
            </script>
        {% else %}
            <h1 class="big-form-title">Хитрите?</h1>
            <div class="big-form-text">
                Вы пытаетесь редактировать чужую статью! У нас так нельзя!
            </div>
        {% endif %}
    {% else %}
        <h1 class="big-form-title">Авторизуйтесь</h1>
        <div class="big-form-text">
            Вы не авторизованы и не можете работать со статьями. <a href="{% url auth_login %}">Войдите</a> и получите эти права.
        </div>
    {% endif %}
{% endblock content %}